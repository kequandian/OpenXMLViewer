<div class="wikidoc"><h1>Functional Overview of OpenXML Viewer</h1>(Download a DOCX version of the Functional Overview <a href=".\3f197a6e-a5c9-439a-92b3-923265e26981">here</a>)
<h2>Executive Summary</h2>The Office OpenXML file format is an approved free and open ISO/IEC standard. The format is based on the Open Packaging Convention (OPC) and is XML based. <br /><br />As it is an open standard and XML based, the OpenXmlViewer Xtensions project provides a guided implementation for visualizing OpenXML based Word 2007 (docx) documents in xHTML, which is open and free in the spirit of Open Source.<br /><br />This document provides a functional overview of the OpenXML Viewer project.<br />
<h2>Basic Use Cases</h2>
The OpenXML Viewer Xtensions project aims at ease of use and browser integrated viewing of Word 2007 documents. <br />The basic use case consists of users who do not have a means to view OpenXML based .docx docu-ments. With the OpenXML Viewer browser extension, the user can convert the word docx document into html and view the contents of the document in a browser.<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=OpenXMLViewer&DownloadId=50142" alt="Usecase1.JPG" title="Usecase1.JPG" /><br />
<h2>Use case: Open DocX File</h2><b>Preconditions</b><br />OpenXML Viewer plugin is installed.<br /><br /><b>Basic Flow</b>
<ul><li>1. User opens document (attachment or fileshare) using the browser</li>
<li>2. Browser detects the document MIME type and extension </li>
<li>3. Browser calls the plugin</li>
<li>4. Plugin initializes and received the document file from the browser</li>
<li>5. Plugin opens the document as per Open Packaging Convention and reads the xml files.</li></ul>
<br /><b>Alternate flow</b>
<ul><li>1. User opens document from the file system.</li>
<li>2. User chooses to open the document file using the OpenXMLViewer.exe commandline application</li>
<li>3. OpenXMLViewer.exe reads the file as per Open Packaging Convention and reads the xml files</li></ul>
<br /><b>Additional Information</b><br />Refer to <a href="http://www.microsoft.com/whdc/xps/downloads.mspx">Open Packaging Specifications</a> for information regarding the OpenOffice Document packaging<br />
<h2>Use case: Convert Docx to xHTML</h2><b>Preconditions</b><br />The Docx file is successfully read (refer use case Open Docx)<br /><br /><b>Basic Flow</b>
<ul><li>1. Plug-in processes various xmls for word features including relationship resolution within the document (links, styles, images etc)</li>
<li>2. Plug-in transforms the xml into xhtml</li>
<li>3. Plug-in displays the converted xHTML to the user.</li></ul>
<br /><b>Future expectations</b><br />The OpenXML transformation engine can be made available across various OSes and platforms like in-ternet tablets, mobile media devices, server based conversion tasks for providing a web preview to Docx documents etc<br />
<h2>Usage guide</h2><b>Browser plug-in</b><br /><br />The browser plug-in, once installed will intercept Word 2007 documents and convert them to html. The basic usage involves clicking on a hyperlink or opening an FTP containing Word 2007 (.docx) files.<br /><br />The browser plug-in will translate the docx stream into xHTML and render it in the same page.<br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=OpenXMLViewer&DownloadId=50143" alt="Usage1.JPG" title="Usage1.JPG" /><br /><br />Consider the case of opening a webpage that contains the Word 2007 document in a hyperlink. Click on hyperlink to open the document.<br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=OpenXMLViewer&DownloadId=50144" alt="Usage2.JPG" title="Usage2.JPG" /><br />Firefox translates the content document into xhtml and displays it in the browser.<br /><br /><b>Command-line interface</b><br /><br />The document translation can also be triggered from the command-line in the shell. Run the following command from the command prompt to convert the docx file to xHtml.<br /><br /><i>Note:</i><br />The command-line utility is available in the extracted folder on windows. On linux, the commandline utility is copied to /usr/local/bin.<br /><br />To process the docx, execute the command as follows.<br /><br />OpenXMLViewer &lt;source file&gt; &lt;destination path&gt;<br /><br />Eg. <br />OpenXMLViewer D:\Input.docx D:\ouput<br />OpenXMLViewer ~/Input.docx ~/ouput<br /><br />The input and destination paths should be absolute paths and not relative paths.<br /><br />The above commands will convert the document and place the output xhtml file and supporting files to the destination path (D:\output\) or ~/output).<br /><br />Once the conversion is complete, the application will launch the file with the associated application (use Open With.. to associate the file type .xhtml with Firefox)<br /></div><div class="ClearBoth"></div>